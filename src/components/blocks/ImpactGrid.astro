---
import { isArray, isEmpty, isObject, isString } from 'radash';
import ImpactStat from '../ui/ImpactStat.astro';

export interface Properties {
  stats: Array<{ label: string; value: string }>;
}

const { stats } = Astro.props as Properties;

const safeStats = isArray(stats)
  ? stats
      .filter((stat) => stat && isObject(stat) && stat.label && stat.value)
      .map((stat) => ({
        label: isString(stat.label) ? stat.label : 'Label',
        value: isString(stat.value) ? stat.value : 'â€”',
      }))
  : [];

if (isEmpty(safeStats)) {
  return;
}
---

<div class='impact-stats'>
  {safeStats.map((s) => <ImpactStat label={s.label} value={s.value} />)}
</div>

<style>
  .impact-stats {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--gap);
    margin-top: var(--heading-gap);
  }

  @media (width >= 768px) {
    .impact-stats {
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--gap-lg);
    }

    .stat-item {
      padding: var(--card-padding-sm);
    }
  }
</style>
