---
import missionData from '../../data/mission.json';
import type { Mission } from '../../types/mission';
import { escapeHtml } from '../../utils/html.ts';

const mission = missionData as Mission;
const { name, mission: missionStatement, description } = mission;
const descriptionHtml = description
  ? description
      .split('\n\n')
      .filter((p) => p.trim())
      .map((p) => {
        const escaped = escapeHtml(p);
        const bolded = escaped.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        return bolded;
      })
  : [];
---

<section class='mission' aria-labelledby='mission-name'>
  <h1 id='mission-name' class='mission-name'>{name}</h1>
  {missionStatement && <p class='mission-statement'>{missionStatement}</p>}

  {
    descriptionHtml.length > 0 && (
      <div class='mission-bio'>
        {descriptionHtml.map((html: string) => (
          <p class='mission-bio-text' set:html={html} />
        ))}
      </div>
    )
  }
</section>

<style>
  .mission {
    margin-top: var(--section-gap);
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .mission-name {
    text-align: center;
    font-size: 2.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: var(--space-xs);
  }

  .mission-statement {
    font-size: var(--font-size-lg);
    font-weight: 400;
    color: var(--text-secondary);
  }

  .mission-bio {
    margin-top: var(--heading-gap);
    max-width: 32rem;
  }

  .mission-bio .mission-bio-text {
    font-size: var(--font-size-lg);
    font-weight: 400;
    color: var(--text-primary);
    line-height: 1.6;
    margin-top: 1em;
  }

  .mission-bio .mission-bio-text:first-child {
    margin-top: 0;
  }
</style>
