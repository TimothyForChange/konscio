---
import { isString } from 'radash';
import { formatKeyToTitle, formatText } from '../../utils/text.ts';

export interface Properties {
  environmentalImpact?: Record<string, string>;
}

const { environmentalImpact } = Astro.props as Properties;
---

{
  environmentalImpact && Object.keys(environmentalImpact).length > 0 && (
    <section
      class='environmental-section'
      aria-labelledby='environmental-heading'
    >
      <h2 id='environmental-heading'>Environmental Impact</h2>

      {Object.entries(environmentalImpact)
        .filter(
          ([key, value]) =>
            isString(key) &&
            isString(value) &&
            key.trim() !== '' &&
            value.trim() !== ''
        )
        .map(([key, value]) => (
          <div class='term-group'>
            <h3>{formatKeyToTitle(key)}</h3>
            <p set:html={formatText(value)} />
          </div>
        ))}
    </section>
  )
}

<style>
  .environmental-section {
    margin-bottom: var(--section-gap);
  }

  .environmental-section h2 {
    font-size: var(--section-heading-size);
    font-weight: var(--font-weight-bold);
    color: var(--text-primary);
    margin-bottom: var(--heading-gap);
    border-bottom: var(--section-heading-border);
    padding-bottom: var(--section-heading-padding-bottom);
  }

  .environmental-section h3 {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    color: var(--text-primary);
    margin-bottom: var(--gap);
    margin-top: var(--heading-gap);
  }

  .term-group {
    margin-bottom: calc(var(--heading-gap) * 1.25);
  }

  .term-group:last-child {
    margin-bottom: 0;
  }

  .term-group:first-child h3 {
    margin-top: 0;
  }

  @media (width >= 768px) {
    .environmental-section h2 {
      font-size: var(--section-heading-size-lg);
    }
  }
</style>
